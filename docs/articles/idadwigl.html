<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iDADwigl - a R package for open-system uranium-thorium dating • iDADwigl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="iDADwigl - a R package for open-system uranium-thorium dating">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">iDADwigl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/idadwigl.html">iDADwigl - a R package for open-system uranium-thorium dating</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/benmarwick/iDADwigl">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>iDADwigl - a R package for open-system uranium-thorium dating</h1>
                        <h4 class="author">Anthony Dosseto<span class="math inline">\(^1\)</span><span class="math inline">\(^,\)</span><span class="math inline">\(^*\)</span> and Ben Marwick<span class="math inline">\(^2\)</span>
</h4>
            
            <h4 class="date">2018-12-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/benmarwick/iDADwigl/blob/master/vignettes/idadwigl.Rmd"><code>vignettes/idadwigl.Rmd</code></a></small>
      <div class="hidden name"><code>idadwigl.Rmd</code></div>

    </div>

    
    
<p><span class="math inline">\(^1\)</span>Wollongong Isotope Geochronology Laboratory, School of Earth &amp; Envrionmental Sciences. University of Wollongong. Wollongong NSW Australia</p>
<p><span class="math inline">\(^2\)</span>Department of Anthropology, University of Washington, Seattle, WA, USA</p>
<p><span class="math inline">\(^*\)</span>Corresponding author: <a href="mailto:tonyd@uow.edu.au" class="email">tonyd@uow.edu.au</a></p>

<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Open-system uranium-thorium (U-Th) dating of teeth and bones, while challenging, has revolutionised our ability to provide reliable chronology for humans and fauna <span class="citation">(Eggins et al., 2005; Sambridge et al., 2012; Grün et al., 2014)</span>. Thus, this approach has significantly improved our understanding of human evolution <span class="citation">(e.g. Dirks et al., 2017; Sutikna et al., 2016)</span>. Uranium-thorium dating is based on the premise that a material takes up U but no Th, so all the <sup>230</sup>Th in the sample comes from decay of <sup>238</sup>U. If detrital Th is included to the sample, a correction must be included to account for the fraction of <sup>230</sup>Th which is detrital and not derived from <sup>238</sup>U decay. Another requirement is that there is no gain or loss of <sup>230</sup>Th, <sup>234</sup>U or <sup>238</sup>U after formation of the material. While it is often the case for many geological samples such as corals or speleothems, this requirement is rarely met for teeth and bone (although enamel can sometimes be quite impervious to isotope gain or loss). Thus, for teeth and bone, U-Th dating requires to take into account open system behaviour. The diffusion-adsorption-decay (DAD) model developed by Sambridge et al. <span class="citation">(2012)</span> was instrumental to implement successfully open-system U-Th dating. It allows for advective and diffusive transport of uranium and thorium isotopes, while include synchronous radioactive decay. The software implementation was written in Fortran and is available as a Java GUI (<a href="http://www.iearth.org.au/codes/iDaD/" class="uri">http://www.iearth.org.au/codes/iDaD/</a>). In this article, we propose a R package which implements the model of Sambridge et al. <span class="citation">(2012)</span>.</p>
<p>The motivation for providing this model as an R package is to increase the transparency, reproducibility, and flexibility of the analytical workflow for computing U-Th ages. Currently it is difficult to include the Java GUI in a fully scripted data analysis so the method for computing the DAD model is not highly transparent. This can obscure steps where key decisions are made that are important for others to see to verify the reliability of the analysis. Enabling a scripted workflow for computational analysis of geoscience data is important for improving the reproducibiltiy of results. Reproducibility refers the ability to recreate the results or retest the hypotheses leading to a scientific claim, either by rerunning the same code used by the original authors, or by writing new code. High rates of irreproducibility of research results have been estimated in several fields and disciplines <span class="citation">(Ioannidis, 2005; Institute, 2013; Collaboration and others, 2015; Freedman et al., 2015; Medical Sciences, 2015; Camerer et al., 2016; Camerer et al., 2018)</span>. Consequently, the transparency, openness, and reproducibility of results and methods are receiving increased attention, and the norms of research in many fields are changing <span class="citation">(Miguel et al., 2014; Nosek et al., 2015)</span>.</p>
<p>There is strong interest in open, transparent, and reusable research in the geoscience community <span class="citation">(Gil et al., 2016)</span> and substantial progress toward open data has been made in the geosciences with the widespread use of data services of NASA, USGS, NOAA and community-built data portals such as OneGeology, EarthChem, RRUFF, PANGAEA, PaleoBioDB, and others <span class="citation">(Kattge et al., 2014; Ma, 2018)</span>. However, the use of open source software such as R <span class="citation">(Pebesma et al., 2012)</span>, and sharing of scripted data analysis workflows with research publications is not yet widespread <span class="citation">(Hutton et al., 2016)</span>. With this R package our goal is to make scripted and reproducible data analysis easy for open-system uranium-thorium dating. This will improve the transparency of geochronology research, and provide a more credible and robust foundation for scientific advancement <span class="citation">(Hutton et al., 2016)</span>.</p>
</div>
<div id="methods" class="section level1">
<h1 class="hasAnchor">
<a href="#methods" class="anchor"></a>Methods</h1>
<p>Data required for the DAD model are (<sup>230</sup>Th/<sup>238</sup>U) and (<sup>234</sup>U/<sup>238</sup>U) activity ratios collected along a transect perpendicular to the surface of the tooth or bone (brackets denote activity ratios throughout this article). Sampling for analysis can be done by micro-drilling or laser ablation. If the former, aliquots are then dissolved, followed by separation of U and Th using ion exchange chromatography. This is more time consuming (at least one week of work) than laser ablation, where the material sampled by the laser is directly sent to the mass spectrometer.</p>
<p>While laser ablation also offers a better spatial resolution than micro-drilling, the precision of the data is inferior because of the much smaller amount of material sampled. Uranium and thorium isotope ratios are then analysed by multi-collector inductively-coupled plasma mass spectrometry. A plasma ionise all U and Th atoms, their isotopes are separated through a magnetic field and each collected in a different collector. If using laser ablation, it is best to have two ion counters so <sup>230</sup>Th and <sup>234</sup>U can be collected simultaneously.</p>
<p>The distance of each analysis location from the inner and outer surfaces of the bones, for instance, needs to be recorded. One surface is given a coordinate of 1 and the other one -1, thus coordinates of analyses take values in between (Figure @ref(fig:femurpic)).</p>
</div>
<div id="installing-and-attaching-the-package" class="section level1">
<h1 class="hasAnchor">
<a href="#installing-and-attaching-the-package" class="anchor"></a>Installing and attaching the package</h1>
<p>To run the model, start <code>R</code> and install the package from GitHub. There are many ways to do this, one simple method is shown in the line below. This only needs to be done once per computer.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/source">source</a></span>(<span class="st">"https://install-github.me/tonydoss/iDADwigl"</span>)</a></code></pre></div>
<p>For routine data analysis, R scripts need to contain this line to attach the package to the current working envirovnment. This line needs to be run at the start of each analysis:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># attach the package</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(iDADwigl)</a></code></pre></div>
</div>
<div id="input-data-format" class="section level1">
<h1 class="hasAnchor">
<a href="#input-data-format" class="anchor"></a>Input data format</h1>
<p>The key function of our package, <code><a href="../reference/iDADwigl.html">iDADwigl()</a></code> requires a data frame with the following column names:</p>
<ul>
<li><code>iDAD.position</code></li>
<li><code>U234_U238_CORR</code></li>
<li><code>U234_U238_CORR_Int2SE</code></li>
<li><code>iDAD.position.1</code></li>
<li><code>Th230_U238_CORR</code></li>
<li><code>Th230_U238_CORR_Int2SE</code></li>
<li><code>U_ppm</code></li>
<li><code>U_ppm_Int2SE</code></li>
</ul>
<p>This data frame can be created by importing an Excel or CSV file into the R environment using a generic function such as <code>read.csv</code> or <code>read_excel</code> from the <code>readxl</code> package <span class="citation">(Wickham and Bryan, 2018)</span>. To help with preparing data for input into our function, we have included two examples of input files. The code chunk below shows how to access one of the two example CSV files included in the package, and how to read it into the R environment.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># get the path the one of the CSV files included in the package</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">path_to_included_example_csv_file &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"extdata"</span>, </a>
<a class="sourceLine" id="cb3-4" data-line-number="4">            <span class="st">"input/Hobbit_MH2T_for_iDAD.csv"</span>, </a>
<a class="sourceLine" id="cb3-5" data-line-number="5">            <span class="dt">package =</span> <span class="st">"iDADwigl"</span>,</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">            <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co"># read in the example CSV file included in the package</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">Hobbit_MH2T_for_iDAD &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/read.table">read.csv</a></span>(path_to_included_example_csv_file)</a></code></pre></div>

<p>Table @ref(tab:hobbitone) shows the data contained in the <code>Hobbit_MH2T_for_iDAD.csv</code> file included in the package</p>

<p>The columns <code>iDAD.position</code>, <code>U234_U238_CORR</code>, <code>U234_U238_CORR_Int2SE</code>, <code>Th230_U238_CORR</code> and <code>Th230_U238_CORR_Int2SE</code> must be present in the input data frame with these exact names for the model to function. The <code><a href="../reference/iDADwigl.html">iDADwigl()</a></code> function will check if the input data frame has these columns, and will stop with an error message if it does not find these columns. The <code>names</code> function can be used to update column names of a data frame to ensure they match the names that the model function requires. The order of the columns in the data frame is not important.</p>
<p>The <code>iDAD.position</code> column corresponds to the coordinates of the (<sup>234</sup>U/<sup>238</sup>U) analyses, which as indicated above take values between -1 and 1 (Figure @ref(fig:femurpic)). The second <code>iDAD.position.1</code> column is used if the coordinates of the (<sup>230</sup>Th/<sup>238</sup>U) analyses are different from those of the (<sup>234</sup>U/<sup>238</sup>U) analyses.</p>
<p>Columns <code>U234_U238_CORR</code> and <code>U234_U238_CORR_Int2SE</code> are the (<sup>234</sup>U/<sup>238</sup>U) activity ratios and their 2<span class="math inline">\(\sigma\)</span> errors. Columns <code>Th230_U238_CORR</code> and <code>Th230_U238_CORR_Int2SE</code> are the (<sup>230</sup>Th/<sup>238</sup>U) activity ratios and their 2<span class="math inline">\(\sigma\)</span> errors.</p>
<p>Columns <code>U_ppm</code> and <code>U_ppm_Int2SE</code> and calculated uranium concentrations (in ppm) and their 2<span class="math inline">\(\sigma\)</span> errors. Uranium concentrations are not necessary for the model and only used for display of the U concentration profile in a figure.</p>
<p>(ref:femurpiccap) Modern human femur (132A/LB/27D/03) from Liang Bua, Flores, Indonesia. Two analysis transects can be seen. For a given transect, the outer and inner surface of the bone are given 1 and -1 reference coordinates, and the position of each analysis is calculated accordingly. Modified from Sutikna et al. <span class="citation">(2016)</span></p>
<div class="figure">
<img src="figures/bone.png" alt="(ref:femurpiccap)" width="75%"><p class="caption">
(ref:femurpiccap)
</p>
</div>

</div>
<div id="details-of-the-input-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#details-of-the-input-parameters" class="anchor"></a>Details of the input parameters</h1>
<p>Our key function, <code><a href="../reference/iDADwigl.html">iDADwigl()</a></code> has several arguments that need to be set before we can get meaningful results.</p>
<p><code>nbit</code> is the number of iterations. For the first run, set to 1.</p>
<p><code>fsum_target</code> is the sum of the squared differences between the calculated and observed activity ratios. Give it a low value to start with (e.g. 0.05). If script takes too long, try a higher value for fsum_target.</p>
<p><code>U48_0_min</code> and <code>U48_0_max</code> are the minimum and maximum values allowed for the (<sup>234</sup>U/<sup>238</sup>U) activity ratio at the surface of the sample. Since (<sup>234</sup>U/<sup>238</sup>U) does not vary greatly over the time period generally studied, the values measured near the surface of the sample can be used as a guide. These values can be adjusted if the model fit to the data is not optimal. For Hobbit_1-1T it is 1.3 and 1.4, and for Hobbit_MH2T it is 1.265 and 1.275.</p>
<p><code>l</code> is the thickness of the sample in centimeters. For Hobbit_1-1T it is 3.5 cm, for Hobbit_MH2T it is 5.35 cm</p>
<p><code>U_0</code> is the Uranium concentration at the surface in ppm. This value does not significantly affect the model results and values from analyses near either surface of the sample can be used as a guide. For Hobbit_1-1T it is 15 ppm; Hobbit_MH2T is 25 ppm.</p>
<p><code>K_min</code> and <code>K_max</code> are the minimum and maximum values allowed for the uranium diffusion coefficient (in cm<sup>2</sup>/s). Values between 10<sup>-13</sup> and 10<sup>-11</sup> cm<sup>2</sup>/s are generally appropriate.</p>
<p><code>T_min</code> and <code>T_max</code> are the minimum and maximum values for the age of the specimen (yr). If there is no estimated knowledge of the sample age, the range of values can be 1,000 to 500,000 yr and adjusted later. For Hobbit_1-1T it is 50e3 and 100e3, and for Hobbit_MH2T it is 1e3 and 20e3.</p>
<p>After setting the <code>U480</code> maximum and minimum values, run the function and adjust these min and max values by looking at the calculated <code>U48_0_final</code>, <code>K_final</code>, and <code>T_final</code>. As you iterate, increase the <code>nbit</code> value to reduce the error.</p>
</div>
<div id="how-to-run-the-model" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-run-the-model" class="anchor"></a>How to run the model</h1>
<p>To run the function, attach the package and then run <code><a href="../reference/iDADwigl.html">iDADwigl()</a></code>, specifying the input data frame and the input parameters as described above. The code block below shows a quick example that will execute in less than five seconds on a typical 2.3 GHz Intel Core i5 laptop:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">output &lt;-<span class="st"> </span><span class="kw"><a href="../reference/iDADwigl.html">iDADwigl</a></span>(Hobbit_MH2T_for_iDAD,</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">                   <span class="dt">nbit =</span> <span class="dv">500</span>,</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">                   <span class="dt">fsum_target =</span> <span class="fl">0.01</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                   <span class="dt">U48_0_min =</span> <span class="fl">1.265</span>, </a>
<a class="sourceLine" id="cb4-5" data-line-number="5">                   <span class="dt">U48_0_max =</span> <span class="fl">1.275</span>, </a>
<a class="sourceLine" id="cb4-6" data-line-number="6">                   <span class="dt">l =</span> <span class="fl">5.35</span>, </a>
<a class="sourceLine" id="cb4-7" data-line-number="7">                   <span class="dt">U_0 =</span> <span class="dv">25</span>, </a>
<a class="sourceLine" id="cb4-8" data-line-number="8">                   <span class="dt">K_min =</span> <span class="fl">1e-13</span>,</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">                   <span class="dt">K_max =</span> <span class="fl">1e-11</span>,</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">                   <span class="dt">T_min =</span> <span class="fl">1e3</span>, </a>
<a class="sourceLine" id="cb4-11" data-line-number="11">                   <span class="dt">T_max =</span> <span class="fl">20e3</span>)</a></code></pre></div>
<p>When run the R console, this function will print a confirmation that the input data frame has the required columns, and print the resulting age value with an error reported as the 67% and 33% quantiles, as follows:</p>
<pre><code>All required columns are present in the input data 👍
[1] "Age: 7 +0.6/-0.7 ka"</code></pre>
<p>In a typical analysis we will explore the model fit by changing the range of allowed values for the (<sup>234</sup>U/<sup>238</sup>U) ratio at the surface and the age of the sample, and by decreasing the <code>fsum_target</code>. Once we obtain a satisfying fit (by visual inspection of the produced figures), we would increase <code>nbit</code> to a higher value (e.g. 1000) and run the model again.</p>
<div id="inspecting-the-models-output" class="section level2">
<h2 class="hasAnchor">
<a href="#inspecting-the-models-output" class="anchor"></a>Inspecting the model’s output</h2>
<p>The function also produces a list object containing more detailed results, including a one-row data frame summarising the age:</p>

<p>The output also includes the calculated <code>T_final</code>, <code>K_final</code>, and `U48_0_final values</p>
<!-- what are these, and what should the user be looking for with these? I think we need some more explanation, and I have no idea! -->
<p>The last item in the output is a copy of the input data with two additional columns, the calculated activity ratios, <sup>234</sup>U/<sup>238</sup>U and <sup>230</sup>Th/<sup>238</sup>U, for each measurement location on the sample.</p>

</div>
<div id="visualising-the-models-output" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-the-models-output" class="anchor"></a>Visualising the model’s output</h2>
<p>We can make some plots… <!-- I'll combine these into a multipanel plot--></p>
<p>T```{r tsol, echo=FALSE, library(ggplot2)</p>
<p>T_sol_plot &lt;- ggplot(output$T_sol, aes(T_sol)) + geom_histogram(binwidth = 500, fill = “white”, color = “black”) + theme_plots</p>
<pre><code>

T``{r th230u238, echo=FALSE,}

th230u238_plot &lt;- 
ggplot(output$output_data) +
  geom_errorbar(
    aes(
      x = iDAD.position,
      ymax = Th230_U238_CORR + Th230_U238_CORR_Int2SE,
      ymin = Th230_U238_CORR - Th230_U238_CORR_Int2SE,
      width = 0.02
    )
  ) + # plot error bars
  geom_point(aes(iDAD.position, Th230_U238_CORR),
             color = 'blue',
             size = 5) +
  geom_point(aes(iDAD.position, Th230_U238_CALC),
             color = 'red',
             size = 5) +
  ylab(expression("(" ^ 230 * "Th/" ^ 238 * "U)")) + xlab("Relative distance from center") +
  theme_plots + ggtitle(paste(
    "Age: ",
    round(output$T_final / 1000, digits = 1),
    " +",
    round((quantile(output$T_sol$T_sol, .67) - output$T_final) / 1000, digits = 1),
    "/-",
    round((output$T_final - quantile(output$T_sol$T_sol, .33)) / 1000, digits = 1),
    " ka",
    sep = ""
  ))</code></pre>
<p><code>{r} echo=FALSE U_ppm_plot &lt;-  ggplot(output$output_data) +   geom_errorbar(     aes(       x = iDAD.position,       ymax = U_ppm + U_ppm_Int2SE,       ymin = U_ppm - U_ppm_Int2SE,       width = 0.02     )   ) + # plot error bars   geom_point(aes(iDAD.position, U_ppm), color = 'blue', size = 5) +   ylab("U (ppm)") + xlab("Relative distance from center") +   theme_plots</code></p>
<p>```{r} echo=FALSE</p>
<p>u234_u238_plot &lt;- ggplot(output$output_data) + geom_errorbar( aes( x = iDAD.position, ymax = U234_U238_CORR + U234_U238_CORR_Int2SE, ymin = U234_U238_CORR - U234_U238_CORR_Int2SE, width = 0.02 ) ) + # plot error bars geom_point(aes(iDAD.position, U234_U238_CORR), color = ‘blue’, size = 5) + geom_point(aes(iDAD.position, U234_U238_CALC ), color = ‘red’, size = 5) + ylab(expression(“(” ^ 234 * “U/” ^ 238 * “U)”)) + xlab(“Relative distance from center”) + theme_plots</p>
<p>```</p>
<p><code>{r} echo=FALSE # combine plots library(patchwork) (T_sol_plot + Uth230u238_plot  / (tU_ppm_plot+ u234_u238_plot)</code></p>
</div>
</div>
<div id="case-study-of-the-age-of-the-hobbit-from-sutikna-et-al-2016" class="section level1">
<h1 class="hasAnchor">
<a href="#case-study-of-the-age-of-the-hobbit-from-sutikna-et-al-2016" class="anchor"></a>Case study of the age of the Hobbit from Sutikna et al. 2016</h1>
<p>The package includes two sample data sets derived from <span class="citation">Sutikna et al. (2016)</span> : “Hobbit_MH2T_for_iDAD.csv” is data from transect 2 for modern human femur 132A/LB/27D/03. “Hobbit_1-1T_for_iDAD.csv” is data from transect 1 for <em>Homo floresiensis</em> ulna LB1/52. For the latter, six analyses were removed from the set as in <span class="citation">Sutikna et al. (2016)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">kableExtra<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(Hobbit_MH2T_for_iDAD[ , <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                  <span class="dt">caption =</span> <span class="st">"Preview of the data from transect 2 for modern human femur 132A/LB/27D/03, included in our R package."</span>)</a></code></pre></div>
<table class="table">
<caption>
Preview of the data from transect 2 for modern human femur 132A/LB/27D/03, included in our R package.
</caption>
<thead><tr>
<th style="text-align:right;">
iDAD.position
</th>
<th style="text-align:right;">
U234_U238_CORR
</th>
<th style="text-align:right;">
U234_U238_CORR_Int2SE
</th>
<th style="text-align:right;">
iDAD.position.1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.9558824
</td>
<td style="text-align:right;">
1.269622
</td>
<td style="text-align:right;">
0.00421
</td>
<td style="text-align:right;">
-0.9558824
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.8568112
</td>
<td style="text-align:right;">
1.272934
</td>
<td style="text-align:right;">
0.00424
</td>
<td style="text-align:right;">
-0.8568112
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.7577400
</td>
<td style="text-align:right;">
1.265424
</td>
<td style="text-align:right;">
0.00372
</td>
<td style="text-align:right;">
-0.7577400
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.6586688
</td>
<td style="text-align:right;">
1.267345
</td>
<td style="text-align:right;">
0.00454
</td>
<td style="text-align:right;">
-0.6586688
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.5595976
</td>
<td style="text-align:right;">
1.269155
</td>
<td style="text-align:right;">
0.00291
</td>
<td style="text-align:right;">
-0.5595976
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.4605263
</td>
<td style="text-align:right;">
1.265515
</td>
<td style="text-align:right;">
0.00284
</td>
<td style="text-align:right;">
-0.4605263
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.3614551
</td>
<td style="text-align:right;">
1.266979
</td>
<td style="text-align:right;">
0.00255
</td>
<td style="text-align:right;">
-0.3614551
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2623839
</td>
<td style="text-align:right;">
1.276018
</td>
<td style="text-align:right;">
0.00231
</td>
<td style="text-align:right;">
-0.2623839
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.1633127
</td>
<td style="text-align:right;">
1.265514
</td>
<td style="text-align:right;">
0.00228
</td>
<td style="text-align:right;">
-0.1633127
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.0642000
</td>
<td style="text-align:right;">
1.276682
</td>
<td style="text-align:right;">
0.00210
</td>
<td style="text-align:right;">
-0.0642000
</td>
</tr>
<tr>
<td style="text-align:right;">
0.0348000
</td>
<td style="text-align:right;">
1.270634
</td>
<td style="text-align:right;">
0.00223
</td>
<td style="text-align:right;">
0.0348000
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1339009
</td>
<td style="text-align:right;">
1.264266
</td>
<td style="text-align:right;">
0.00242
</td>
<td style="text-align:right;">
0.1339009
</td>
</tr>
<tr>
<td style="text-align:right;">
0.2329721
</td>
<td style="text-align:right;">
1.266220
</td>
<td style="text-align:right;">
0.00273
</td>
<td style="text-align:right;">
0.2329721
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3320434
</td>
<td style="text-align:right;">
1.264971
</td>
<td style="text-align:right;">
0.00224
</td>
<td style="text-align:right;">
0.3320434
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4311146
</td>
<td style="text-align:right;">
1.265578
</td>
<td style="text-align:right;">
0.00284
</td>
<td style="text-align:right;">
0.4311146
</td>
</tr>
<tr>
<td style="text-align:right;">
0.5301858
</td>
<td style="text-align:right;">
1.267986
</td>
<td style="text-align:right;">
0.00264
</td>
<td style="text-align:right;">
0.5301858
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6292570
</td>
<td style="text-align:right;">
1.264463
</td>
<td style="text-align:right;">
0.00258
</td>
<td style="text-align:right;">
0.6292570
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7283282
</td>
<td style="text-align:right;">
1.262701
</td>
<td style="text-align:right;">
0.00200
</td>
<td style="text-align:right;">
0.7283282
</td>
</tr>
<tr>
<td style="text-align:right;">
0.8273994
</td>
<td style="text-align:right;">
1.265848
</td>
<td style="text-align:right;">
0.00471
</td>
<td style="text-align:right;">
0.8273994
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9264706
</td>
<td style="text-align:right;">
1.262668
</td>
<td style="text-align:right;">
0.00316
</td>
<td style="text-align:right;">
0.9264706
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">kableExtra<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/kableExtra/topics/reexports">kable</a></span>(Hobbit_<span class="dv">1</span>_1T_for_iDAD[ , <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>],</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                  <span class="dt">caption =</span> <span class="st">"Preview of the data from transect 1 for Homo floresiensis ulna LB1/52, included in our R package."</span>)</a></code></pre></div>
<table class="table">
<caption>
Preview of the data from transect 1 for Homo floresiensis ulna LB1/52, included in our R package.
</caption>
<thead><tr>
<th style="text-align:right;">
iDAD.position
</th>
<th style="text-align:right;">
U234_U238_CORR
</th>
<th style="text-align:right;">
U234_U238_CORR_Int2SE
</th>
<th style="text-align:right;">
iDAD.position.1
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.1425926
</td>
<td style="text-align:right;">
1.368887
</td>
<td style="text-align:right;">
0.00244
</td>
<td style="text-align:right;">
-0.1425926
</td>
</tr>
<tr>
<td style="text-align:right;">
0.1648148
</td>
<td style="text-align:right;">
1.370083
</td>
<td style="text-align:right;">
0.00236
</td>
<td style="text-align:right;">
0.1648148
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3185185
</td>
<td style="text-align:right;">
1.363741
</td>
<td style="text-align:right;">
0.00215
</td>
<td style="text-align:right;">
0.3185185
</td>
</tr>
<tr>
<td style="text-align:right;">
0.4722222
</td>
<td style="text-align:right;">
1.362125
</td>
<td style="text-align:right;">
0.00252
</td>
<td style="text-align:right;">
0.4722222
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6259259
</td>
<td style="text-align:right;">
1.365091
</td>
<td style="text-align:right;">
0.00292
</td>
<td style="text-align:right;">
0.6259259
</td>
</tr>
<tr>
<td style="text-align:right;">
0.7796296
</td>
<td style="text-align:right;">
1.373882
</td>
<td style="text-align:right;">
0.00273
</td>
<td style="text-align:right;">
0.7796296
</td>
</tr>
</tbody>
</table>
<p>For transect 2 of 132A/LB/27D/03, Sutikna et al. <span class="citation">(2016)</span> reported an age of 7.4 <span class="math inline">\(\pm\)</span> 0.5 ka (thousand years before 2014). With iDADwigl, we obtain an age of 7.1 +0.6/-0.7 ka (Figs. 2-4). We obtained our age for</p>
<p>For transect 1 of LB1/52, Sutikna et al. <span class="citation">(2016)</span> reported an age of 79.0 <span class="math inline">\(\pm\)</span> 3.7 ka. With iDADwigl, we obtain an age of 75.4 <span class="math inline">\(\pm\)</span> 0.9 ka.</p>
<div class="figure">
<img src="figures/U_Hobbit_MH2T_DAD.png" alt="Uranium concentration profile for transect 2 of modern human femur 132A/LB/27D/03"><p class="caption">Uranium concentration profile for transect 2 of modern human femur 132A/LB/27D/03</p>
</div>
<div class="figure">
<img src="figures/R48_Hobbit_MH2T_DAD.png" alt="Calculated (red) and observed (blue) (234U/238U) activity ratios for transect 2 of modern human femur 132A/LB/27D/03."><p class="caption">Calculated (red) and observed (blue) (<sup>234</sup>U/<sup>238</sup>U) activity ratios for transect 2 of modern human femur 132A/LB/27D/03.</p>
</div>
<div class="figure">
<img src="figures/R08_Hobbit_MH2T_DAD.png" alt="Calculated (red) and observed (blue) (230Th/238U) activity ratios for transect 2 of modern human femur 132A/LB/27D/03"><p class="caption">Calculated (red) and observed (blue) (<sup>230</sup>Th/<sup>238</sup>U) activity ratios for transect 2 of modern human femur 132A/LB/27D/03</p>
</div>

</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Camerer1433">
<p>Camerer C. F., Dreber A., Forsell E., Ho T.-H., Huber J., Johannesson M., Kirchler M., Almenberg J., Altmejd A., Chan T., Heikensten E., Holzmeister F., Imai T., Isaksson S., Nave G., Pfeiffer T., Razen M. and Wu H. (2016) Evaluating replicability of laboratory experiments in economics. <em>Science</em> <strong>351</strong>, 1433–1436. Available at: <a href="http://science.sciencemag.org/content/351/6280/1433">http://science.sciencemag.org/content/351/6280/1433</a>.</p>
</div>
<div id="ref-camerer2018evaluating">
<p>Camerer C. F., Dreber A., Holzmeister F., Ho T.-H., Huber J., Johannesson M., Kirchler M., Nave G., Nosek B. A., Pfeiffer T. and others (2018) Evaluating the replicability of social science experiments in nature and science between 2010 and 2015. <em>Nature Human Behaviour</em> <strong>2</strong>, 637.</p>
</div>
<div id="ref-open2015estimating">
<p>Collaboration O. S. and others (2015) Estimating the reproducibility of psychological science. <em>Science</em> <strong>349</strong>, aac4716.</p>
</div>
<div id="ref-Dirks2017">
<p>Dirks P. H., Roberts E. M., Hilbert-Wolf H., Kramers J. D., Hawks J., Dosseto A., Duval M., Elliott M., Evans M., Grun R., Hellstrom J., Herries A. I., Joannes-Boyau R., Makhubela T. V., Placzek C. J., Robbins J., Spandler C., Wiersma J., Woodhead J. and Berger L. R. (2017) The age of homo naledi and associated sediments in the rising star cave, south africa. <em>Elife</em> <strong>6</strong>. Available at: <a href="https://www.ncbi.nlm.nih.gov/pubmed/28483040">https://www.ncbi.nlm.nih.gov/pubmed/28483040</a>.</p>
</div>
<div id="ref-Eggins2005">
<p>Eggins S. M., Grün R., McCulloch M. T., Pike A. W. G., Chappell J., Kinsley L., Mortimer G., Shelley M., Murray-Wallace C. V., Spötl C. and Taylor L. (2005) In situ u-series dating by laser-ablation multi-collector icpms: New prospects for quaternary geochronology. <em>Quaternary Science Reviews</em> <strong>24</strong>, 2523–2538.</p>
</div>
<div id="ref-freedman2015economics">
<p>Freedman L. P., Cockburn I. M. and Simcoe T. S. (2015) The economics of reproducibility in preclinical research. <em>PLoS biology</em> <strong>13</strong>, e1002165.</p>
</div>
<div id="ref-Gil_et_al_2016">
<p>Gil Y., David C. H., Demir I., Essawy B. T., Fulweiler R. W., Goodall J. L., Karlstrom L., Lee H., Mills H. J., Oh J.-H. and al. (2016) Toward the geoscience paper of the future: Best practices for documenting and sharing research from data to software to provenance. <em>Earth and Space Science</em> <strong>3</strong>, 388–415.</p>
</div>
<div id="ref-Gruen2014">
<p>Grün R., Eggins S., Kinsley L., Moseley H. and Sambridge M. (2014) Laser ablation u-series analysis of fossil bones and teeth. <em>Palaeogeography, Palaeoclimatology, Palaeoecology</em> <strong>416</strong>, 150–167. Available at: <a href="http://www.sciencedirect.com/science/article/pii/S0031018214003782">http://www.sciencedirect.com/science/article/pii/S0031018214003782</a>.</p>
</div>
<div id="ref-Hutton_et_al_2016">
<p>Hutton C., Wagener T., Freer J., Han D., Duffy C. and Arheimer B. (2016) Most computational hydrology is not reproducible, so is it really science? <em>Water Resources Research</em> <strong>52</strong>, 7548–7555.</p>
</div>
<div id="ref-global2013case">
<p>Institute G. B. S. (2013) The case for standards in life science research: Seizing opportunities at a time of critical need.</p>
</div>
<div id="ref-ioannidis2005most">
<p>Ioannidis J. P. (2005) Why most published research findings are false. <em>PLoS medicine</em> <strong>2</strong>, e124.</p>
</div>
<div id="ref-Kattge_Díaz_Wirth_2014">
<p>Kattge J., Díaz S. and Wirth C. (2014) Of carrots and sticks. <em>Nature Geoscience</em> <strong>7</strong>, 778.</p>
</div>
<div id="ref-ma2018data">
<p>Ma X. (2018) Data science for geoscience: Leveraging mathematical geosciences with semantics and open data. In <em>Handbook of mathematical geosciences</em> Springer. pp. 687–702.</p>
</div>
<div id="ref-academy2015reproducibility">
<p>Medical Sciences A. of (2015) Reproducibility and reliability of biomedical research: Improving research practice. In <em>Symposium report</em></p>
</div>
<div id="ref-miguel2014promoting">
<p>Miguel E., Camerer C., Casey K., Cohen J., Esterling K. M., Gerber A., Glennerster R., Green D. P., Humphreys M., Imbens G. and others (2014) Promoting transparency in social science research. <em>Science</em> <strong>343</strong>, 30–31.</p>
</div>
<div id="ref-nosek2015promoting">
<p>Nosek B. A., Alter G., Banks G. C., Borsboom D., Bowman S. D., Breckler S. J., Buck S., Chambers C. D., Chin G., Christensen G. and others (2015) Promoting an open research culture. <em>Science</em> <strong>348</strong>, 1422–1425.</p>
</div>
<div id="ref-Pebesma_Nust_Bivand_2012">
<p>Pebesma E., Nüst D. and Bivand R. (2012) The r software environment in reproducible geoscientific research. <em>Eos, Transactions American Geophysical Union</em> <strong>93</strong>, 163–163.</p>
</div>
<div id="ref-Sambridge2012">
<p>Sambridge M., Grün R. and Eggins S. (2012) U-series dating of bone in an open system: The diffusion-adsorption-decay model. <em>Quaternary Geochronology</em>. Available at: <a href="http://www.scopus.com/inward/record.url?eid=2-s2.0-84857958926&amp;partnerID=40&amp;md5=01e7f1b7d3554da26b247125425ff496">http://www.scopus.com/inward/record.url?eid=2-s2.0-84857958926&amp;partnerID=40&amp;md5=01e7f1b7d3554da26b247125425ff496</a>.</p>
</div>
<div id="ref-Sutikna2016">
<p>Sutikna T., Tocheri M. W., Morwood M. J., Saptomo E. W., Jatmiko, Awe R. D., Wasisto S., Westaway K. E., Aubert M., Li B., Zhao J.-x., Storey M., Alloway B. V., Morley M. W., Meijer H. J. M., Bergh G. D. van den, Grün R., Dosseto A., Brumm A., Jungers W. L. and Roberts R. G. (2016) Revised stratigraphy and chronology for homo floresiensis at liang bua in indonesia. <em>Nature</em> <strong>532</strong>, 366–369. Available at: <a href="http://dx.doi.org/10.1038/nature17179">http://dx.doi.org/10.1038/nature17179</a>.</p>
</div>
<div id="ref-Wickham_readxl">
<p>Wickham H. and Bryan J. (2018) <em>Readxl: Read excel files</em>., Available at: <a href="https://CRAN.R-project.org/package=readxl">https://CRAN.R-project.org/package=readxl</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#methods">Methods</a></li>
      <li><a href="#installing-and-attaching-the-package">Installing and attaching the package</a></li>
      <li><a href="#input-data-format">Input data format</a></li>
      <li><a href="#details-of-the-input-parameters">Details of the input parameters</a></li>
      <li>
<a href="#how-to-run-the-model">How to run the model</a><ul class="nav nav-pills nav-stacked">
<li><a href="#inspecting-the-models-output">Inspecting the model’s output</a></li>
      <li><a href="#visualising-the-models-output">Visualising the model’s output</a></li>
      </ul>
</li>
      <li><a href="#case-study-of-the-age-of-the-hobbit-from-sutikna-et-al-2016">Case study of the age of the Hobbit from Sutikna et al. 2016</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Anthony Dosseto, Ben Marwick.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
